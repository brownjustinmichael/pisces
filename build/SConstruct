import os
import SCons.Conftest

env = Environment (ENV = os.environ)

# env ["CXX"] = "/opt/centos/devtoolset-1.1/root/usr/bin/g++"

OCXX = env ["CXX"]
env ["CXX"] = "mpic++"

conf = Configure (env)

if not conf.CheckCXX ():
    env ["CXX"] = OCXX
else:
    env.Append (CPPFLAGS = ["-D_MPI"])
    env.Append (NVCCFLAGS = ["-D_MPI"])

conf.Finish ()

env.Tool ('cuda')

# env = Environment (ENV = os.environ, CXX = "g++")
env.Append (CPPFLAGS = ["-Wall", "-g", "-std=c++0x"])
env.Append (NVCCFLAGS = ["-g", "-arch=sm_20"])

env.SConscript ("../src/SConscript", variant_dir = ".", duplicate = 0, exports = {"env": env})
